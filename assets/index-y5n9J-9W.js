import{r as i}from"./index-CDlOlYQx.js";import{b as y,u as U}from"./index-C1roXhr_.js";import{P as m,d as j}from"./index-DQiZZjoQ.js";import{u as x}from"./index-8pt59J0f.js";import{j as b}from"./jsx-runtime-D_zvdyIk.js";import{R as z}from"./index-BGZCjPBa.js";function P(s){const e=i.useRef(s);return i.useEffect(()=>{e.current=s}),i.useMemo(()=>(...n)=>{var t;return(t=e.current)==null?void 0:t.call(e,...n)},[])}function H(s,e=globalThis==null?void 0:globalThis.document){const n=P(s);i.useEffect(()=>{const t=r=>{r.key==="Escape"&&n(r)};return e.addEventListener("keydown",t,{capture:!0}),()=>e.removeEventListener("keydown",t,{capture:!0})},[n,e])}var K="DismissableLayer",h="dismissableLayer.update",X="dismissableLayer.pointerDownOutside",Y="dismissableLayer.focusOutside",g,T=i.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),B=i.forwardRef((s,e)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:t,onPointerDownOutside:r,onFocusOutside:o,onInteractOutside:l,onDismiss:c,...E}=s,u=i.useContext(T),[d,N]=i.useState(null),f=(d==null?void 0:d.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,F]=i.useState({}),W=x(e,a=>N(a)),D=Array.from(u.layers),[I]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),_=D.indexOf(I),L=d?D.indexOf(d):-1,k=u.layersWithOutsidePointerEventsDisabled.size>0,C=L>=_,M=G(a=>{const v=a.target,R=[...u.branches].some(p=>p.contains(v));!C||R||(r==null||r(a),l==null||l(a),a.defaultPrevented||c==null||c())},f),O=J(a=>{const v=a.target;[...u.branches].some(p=>p.contains(v))||(o==null||o(a),l==null||l(a),a.defaultPrevented||c==null||c())},f);return H(a=>{L===u.layers.size-1&&(t==null||t(a),!a.defaultPrevented&&c&&(a.preventDefault(),c()))},f),i.useEffect(()=>{if(d)return n&&(u.layersWithOutsidePointerEventsDisabled.size===0&&(g=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),u.layersWithOutsidePointerEventsDisabled.add(d)),u.layers.add(d),w(),()=>{n&&u.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=g)}},[d,f,n,u]),i.useEffect(()=>()=>{d&&(u.layers.delete(d),u.layersWithOutsidePointerEventsDisabled.delete(d),w())},[d,u]),i.useEffect(()=>{const a=()=>F({});return document.addEventListener(h,a),()=>document.removeEventListener(h,a)},[]),b.jsx(m.div,{...E,ref:W,style:{pointerEvents:k?C?"auto":"none":void 0,...s.style},onFocusCapture:y(s.onFocusCapture,O.onFocusCapture),onBlurCapture:y(s.onBlurCapture,O.onBlurCapture),onPointerDownCapture:y(s.onPointerDownCapture,M.onPointerDownCapture)})});B.displayName=K;var q="DismissableLayerBranch",S=i.forwardRef((s,e)=>{const n=i.useContext(T),t=i.useRef(null),r=x(e,t);return i.useEffect(()=>{const o=t.current;if(o)return n.branches.add(o),()=>{n.branches.delete(o)}},[n.branches]),b.jsx(m.div,{...s,ref:r})});S.displayName=q;function G(s,e=globalThis==null?void 0:globalThis.document){const n=P(s),t=i.useRef(!1),r=i.useRef(()=>{});return i.useEffect(()=>{const o=c=>{if(c.target&&!t.current){let E=function(){A(X,n,u,{discrete:!0})};const u={originalEvent:c};c.pointerType==="touch"?(e.removeEventListener("click",r.current),r.current=E,e.addEventListener("click",r.current,{once:!0})):E()}else e.removeEventListener("click",r.current);t.current=!1},l=window.setTimeout(()=>{e.addEventListener("pointerdown",o)},0);return()=>{window.clearTimeout(l),e.removeEventListener("pointerdown",o),e.removeEventListener("click",r.current)}},[e,n]),{onPointerDownCapture:()=>t.current=!0}}function J(s,e=globalThis==null?void 0:globalThis.document){const n=P(s),t=i.useRef(!1);return i.useEffect(()=>{const r=o=>{o.target&&!t.current&&A(Y,n,{originalEvent:o},{discrete:!1})};return e.addEventListener("focusin",r),()=>e.removeEventListener("focusin",r)},[e,n]),{onFocusCapture:()=>t.current=!0,onBlurCapture:()=>t.current=!1}}function w(){const s=new CustomEvent(h);document.dispatchEvent(s)}function A(s,e,n,{discrete:t}){const r=n.originalEvent.target,o=new CustomEvent(s,{bubbles:!1,cancelable:!0,detail:n});e&&r.addEventListener(s,e,{once:!0}),t?j(r,o):r.dispatchEvent(o)}var re=B,ie=S,Q="Portal",V=i.forwardRef((s,e)=>{var c;const{container:n,...t}=s,[r,o]=i.useState(!1);U(()=>o(!0),[]);const l=n||r&&((c=globalThis==null?void 0:globalThis.document)==null?void 0:c.body);return l?z.createPortal(b.jsx(m.div,{...t,ref:e}),l):null});V.displayName=Q;export{ie as B,B as D,V as P,re as R,P as u};
